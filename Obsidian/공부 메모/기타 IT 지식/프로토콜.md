- FTP, FTPS, SFTP(SSH) 등이 무엇인가를 살펴봅시다

## 프로토콜
- **디바이스 간 데이터를 교환하기 위한 통신 규약**
	- ex) `http`, `ftp` 등의 프로토콜은 IETF(인터넷기술표준화위원회)에서 RFC(Request For Comment)라는 항목으로 번호를 매겨서 작성하고 있음
	- IETF는 세종대왕이고 RFC는 훈민정음임

#### FTP
- `File Transfer Protocol`
- 서버에서 서비스를 엶 -> 클라이언트에서 접속, 명령어를 이용해 파일을 가져오거나 업로드함
	- `액티브 모드` : 클라이언트가 서버에게 포트를 알려줘서 **서버가 포트로 접근**함
	- `패시브 모드` : 서버가 클라이언트에게 포트를 알려줘서 **클라이언트가 포트로 접근**함
- 예시 : 윈도우 탐색기, filezilla, 알ftp
- FTP는 2개의 포트를 이용함 
	- `21 포트` : 명령어 전달
	- `20 포트` : 데이터 전달
		- 데이터 전달 방식에 따라 `액티브`, `패시브` 가 나뉨
	- 2개의 포트를 이용하므로 `21 포트`에 접속되더라도 `20 포트`나 방화벽 정책에 따라 실제 파일이 오가지 못하는 경우가 생길 수도 있다.

### FTPS
- TLS/SSL을 거쳐서 안전한 채널이다
	- 즉, `공개키 암호화 방식`을 이용해 21번 포트와 20번 포트를 안전하게 암호화한다는 뜻이다
	- `공개키 암호화 방식` : 서버 공개키로 암호화하면 서버가 가진 비공개 개인 키로만 풀 수 있다는 대전제
		- 공개키가 노출되어도 문제가 없음
		- 예시) 서버가 건네주는 보자기(공개키)로 클라이언트가 감싸서 건네주면 그 보자기의 내용물은 서버만 열어볼 수 있는 방식
- SSL/TLS 교환 개요
	1. 클라이언트 -> 서버 : 암호화 정보 전달
	2. 서버 -> 클라이언트 : 서버 인증서 요청(선택 사항)
	3. 클라이언트 : 서버 인증서 확인, 암호화 매개변수 검사
	4. 클라이언트 -> 서버 : 클라이언트 키 교환
		- **비밀키 정보 송신(서버 공개키를 이용해 암호화)**
	5. 클라이언트 -> 서버 : 클라이언트 인증서 송신
	6. 서버 : 클라이언트 인증서 확인(필요한 경우)
	7. 클라이언트 -> 서버 : 클라이언트 완료
	8. 서버 -> 클라이언트 : 서버 완료
	9. 서버 <-> 클라이언트 : 메시지 교환(공유 비밀 키로 암호화)

- 장점
	- FTPS는 사람이 통신을 이해하고 읽을 수 있음
	- 서버 간 파일 전송 실행 허용
	- 강력한 인증 매커니즘 역할을 하는 X.509 인증서 기능과 함께 제공됨
	- 여러 인터넷 통신 인프라에 FTP/ SSL 지원이 내장되어 있음

- 단점
	- 프로토콜에는 디렉토리 목록 표준화 형식 포함 x
	- 보조 데이터 채널의 사용이 요구됨 : 방화벽 뒤에서 사용이 복잡해짐
	- 프로토콜에는 인코딩 / 파일 이름 문자 집합에 대한 지침이 없음
	- 모든 FTP 서버에서 사용 가능한 건 아님
	- 디렉토리, 파일 속성을 보하고 수정하는 표준 방법이 정의되지 않음

#### SFTP
- SSH의 파일 전송 버전이며, SSH와 같은 방식을 이용함
- **SSH(Secure SHell) 방식을 이용해 암호화된 구간을 만들고, 이 구간에서 FTP를 이용한다**는 것 정도만 알아두자

- 장점
	- SFTP는 1개의 연결만 필요하며, 데이터 연결이 필요하지 않다
	- 연결이 안전하게 보호된다
	- 기계가 읽을 수 있고, 균일한 디렉토리 목록을 제공함
	- 프로토콜에서 제공하는 추가 기능에는 파일 잠금, 속성 조작, 권한 작업 및 더 많은 기능이 포함된다.

- 단점
	- 사람이 읽을 때 있는 그대로 기록할 수 없음을 의미하는 이진 통신에 관여함
	- SSH 키의 유효성 검사 & 관리는 더 복잡함
	- SFTP 구성의 표준은 여러 개임
	- .NET 및 VCL에는 SSH/SFTP 지원이 포함되어 있지 않음

- SFTP는 SSH 기반으로 동작하는 FTP가 아니라, 아예 처음부터 설계된 새로운 프로토콜이다.(SSH 확장 프로토콜에 가깝다)