## 1. 링크상태 라우팅과 경로벡터 라우팅

- 링크 : 노드와 노드를 연결하는 것
	- 링크의 상태에 따라 라우팅 테이블을 교환하는 주기가 바뀔 수 있음

- 링크상태 라우팅은 거리벡터와 달리, **내가 가진 정보를 전체 노드와 주고 받게 된다**
	- 따라서 **전체 네트워크의 토폴로지에 대한 구성도**를 만든다.
	- 이렇게 전체 구조를 파악한 상태에서 최종 목적지로 가는 최단 경로를 파악하는 게 `링크 상태 라우팅`이다.
	- `링크 상태`인 이유는, 링크에 **문제가 생기면** 경로를 바꾸기 때문에 그렇다

- 사용 알고리즘 : **Dijkstra's Shortest Path Algorithm**
- 프로토콜 : `OSPF Open Shortest Path First`
	- 비교) 거리벡터는 Bellman-Ford Algorithm / RIP 프로토콜 사용

#### 알고리즘의 동작
- 전체 네트워크의 구성도를 만드는 과정에서, 각 라우터는 인터넷 전체 그림을 그려야 함
- **이웃**에 관한 정보 & **모든** 라우터 & 변화 발생 시 정보 공유
	- 따라서 초반엔 순간적으로 트래픽이 확 증가할 수 있음
![[Pasted image 20221223163206.png]]
- 거리 벡터와 달리 이웃에 대한 정보를 **모든** 라우터에 전달함
-------------------
##### Flooding
- 연결 정보를 보내는 방법으로, 패킷이 **들어온 곳을 제외한 나머지 모든 포트를 통해 정보를 흘려보냄**
- 중복이 발생할 수 있으나, 단기간 정보 전달에 매우 효과적임
 > ex) 같은 정보가 다른 경로를 통해 흘러들어올 수 있을 것
----------------------
-  이렇게 모든 노드가 동일한 테이블을 갖게 됨 : **링크 상태 데이터베이스**
![[Pasted image 20221223163515.png]]

### 경로 벡터 라우팅(Path Vector Routing)
- `BGP(Border Gateway Protocol)`은 자율 시스템 **간**의 라우팅 프로토콜
	- 현재 사용 버전 : BGP4
	- 라우팅 테이블은 목적지까지의 경로가 표시됨
	- 경로는 AS의 리스트로 표현됨

- 왜 씀?
	- `Loop Preventation(루프 방지)`
		- 데이터 수신 시 자율 시스템이 목적지 경로 항목에 있는지 확인
		- 포함되어 있다면 Loop에 포함됐으므로 해당 데이터는 무시
	- `Policy Routing(정책 라우팅)`
		- 경로 벡터 라우팅으로 쉽게 구현 가능
		- 데이터 수신 시 라우터는 경로 확인 가능
		- 경로 확인 시 등록된 AS 중 일부가 정책에 반대되면 그 경로와 목적지를 무시

> 정책 라우팅이 필요했던 사례
>> 인터넷은 최적의 경로를 통해 패킷을 전달함
>> 근데 그 최적의 경로가 직통이 아니라 **돌아서 가는 경우가 더 빠른 케이스**가 있음
>> 근데 정책 라우팅이 없다면 이 트래픽이 어디를 거쳐 지나가는 건지 알 수 없음
>그러면 무슨 문제가 생기냐?
>> 왜 니네 나라(기업)에서 흘러야 할 트래픽이 우리나라(기업)로 와서 자원을 먹느냐? 라는 이슈가 생길 수 있다는 것
> **최적의 경로임에도 이용하면 안되는 상황**이 있을 수 있기 때문에 정책 라우팅이 필요함

![[Pasted image 20221223164108.png]]
- 이렇게 지나가는 `AS`를 한 줄로 쫙 나열하는 걸 `경로 벡터 라우팅` 이라고 한다.

## 2. 멀티 캐스팅
- 유니캐스팅 : 송신자 1개 : 목적지가 하나
- 멀티캐스팅 : 송신자 1개 : 목적지가 여러 개
	- 이 여러 목적지는 `멀티캐스트 그룹`에 속했느냐로 구분할 수 있음
- 브로드캐스팅 : 그룹에 속했는지 여부를 보지 않고 목적지에 `모두`를 갖게 됨

> 근데 애매함 : 그룹이 세계에 퍼져있을 수도 있잖음?

### 멀티캐스트 그룹 관리 

#### IGMP(Internet Group Management Protocol)
- 그룹에 속한 시스템의 가입과 탈퇴를 관리함
- 멀티캐스트 라우터에게 그룹에 속한 시스템에 대한 정보를 제공함
	- 멀티캐스트 라우팅 프로토콜이 아님!
	- 그룹에 대한 관리만을 담당함
- 현재 버전 IGMPv3
- 로컬에서만 작동함
- **단말기 - 라우터 사이에는 IGMP가 동작한다**
	- `라우터 - 라우터` 사이에는 멀티캐스트 라우팅 프로토콜이 동한다

##### IGMP 메시지 
- 2가지 유형의 메시지
	- `query`
		- 라우터가 특정 메시지 그룹이 존재하는지 확인할 때 사용함
		- `General Query Message` : 모든 그룹의 구성원에 보내짐
		- 응답이 없으면 패킷을 더 이상 보내지 않음
	- `report`
		- query에 대한 호스트의 응답
		- 그룹에 가입하는 경우 / 참여하고 있는지 여부에 대한 쿼리 메시지에 응답
		- 호스트가 그룹을 떠나는 경우 쿼리 메시지에 응답하지 않음
			- 라우터 DB에서 제거됨

### 멀티캐스트 라우팅
- 유니캐스팅 라우팅에서는 라우터가 1개의 목적지에 대한 1개의 최적 경로를 가짐
- 멀티캐스팅 라우팅에서는 라우터가 각 그룹에 대한 1개의 최적 경로를 가짐
	- N개의 그룹에 대해 N개의 최적 경로 필요
	- 그룹에 소속된 네트워크는 여러 개 존재함
	- 트리를 구성해 멀티캐스트 패킷을 전달함
![[Pasted image 20221223165232.png]]

- `송신자 기반 트리 Source-Based Tree`
![[Pasted image 20221223165453.png]]
	- 나를 기준으로 뻗어나감(각 구성원이 각자의 트리를 가짐)
	- `DVMRP(Distance Vector Multicast Routing Protocol)` : RIP 프로토콜에 기반해 멀티캐스팅을 가능하게 함
	- `MOSPF(Multicast OSPF)` : OSPF와 같은 링크 상태 라우팅 방식을 확장함
	- `PIM-DF(Protocol Independent Multicast-Dense Mode)` : `RIP`나 `OSPF`를 사용

- `그룹 공유 트리 Group-Shared Tree`
![[Pasted image 20221223165734.png]]
- 그룹은 랑데부 라우터가 만든 트리를 공유함 
- 센터 코어 혹은 `랑데부 라우터`만 그룹에 대한 최적 경로를 구성함
	- 임의의 라우터가 멀티캐스트 패킷을 받음
	- 유니캐스트 패킷으로 캡슐화, 코어 라우터에 전달함
	- 코어 라우터가 멀티캐스트 패킷을 전달
- 멀티캐스트 라우팅 프로토콜
	- `CBT(Core-Based Tree)`
	- `PIM-SM(Sparse-Mode)`