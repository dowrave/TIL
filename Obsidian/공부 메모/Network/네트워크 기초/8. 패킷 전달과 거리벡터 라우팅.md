## 1. 패킷의 전달

### 패킷의 처리
- 인터넷은 여러 네트워크의 연결로 구성
![[Pasted image 20221223153246.png]]
- 크게 3가지로 볼 수 있음
	- 송신자
	- 중간
	- 수신자

#### 1. 송신자
- 송신자의 네트워크 계층에서 패킷이 생성됨
	- 패킷이 너무 클 경우 단편화가 발생함
	- 가장 좋은 경로 선택 : 목적지에 패킷을 전달하기 위해 `라우팅 테이블`을 참조함
		>라우팅 테이블로 모든 게 이뤄진다고 생각해도 무방함

#### 2. 수신자
- IP 패킷의 헤더 검사(목적지 주소가 내 주소와 같은가?)
- 이후 나머지 처리

#### 3. 중간 장치
- 패킷이 들어오면 헤더의 목적지 주소를 봄
	- 어느 쪽으로 보낼 지 `중간 장치가 가지고 있는 라우팅 테이블`을 보고 방향을 결정함
	- 이 라우팅을 전문적으로 하는 장치가 `라우터` 

### 패킷의 전달
- 직접 전달과 간접 전달
	- 직접 전달(Direct Delivery) : 최종 목적지가 전달자와 동일한 네트워크에 있을 때
	- 간접 전달(Indirect Delivery) : 라우터 -> 라우터 전달

- 전달 방법 (라우팅 테이블의 크기를 줄이는 개념이 대부분이다)
	- `이웃 노드 명시 (Next-hop Method)`
		- 라우팅 테이블은 전체 경로상의 라우터를 명시하지 않고 **다음 라우터만을 명시**함
		- A -> R1 -> R2 -> B 의 전체 경로 중 A는 `A->R1`만 명시함
	- `네트워크 주소 명시 (Network-Specific Method)`
		- 동일한 네트워크의 컴퓨터들을 모두 명시하지 않고, 목적지 네트워크 주소만 명시함
		- `192.168.10.20`인 경우 `192.168.10.0`으로 **네트워크 주소만 라우팅 테이블에 등록**함
			- 즉 네트워크 주소와 호스트 주소를 모두 표시하지 않고, 네트워크 주소만 표시함
	- `호스트 주소 명시 (Host-Specific Method)`
		- 라우팅 테이블에 목적지 컴퓨터 주소를 직접 명시 가능
		- 비효율적이나, 특별한 목적이 있는 경우 포함 가능
		- 호스트 명시가 네트워크 명시보다 우선권을 가짐
	- `디폴트 지정(Default Method)`
		- 인터넷의 모든 목적지를 지정할 수 없으므로, 지정된 목적지 이외의 영역을 지정하는 라우팅 엔트리를 `디폴트`라고 함(네트워크 주소 : `0.0.0.0`으로 표기됨)
		- `디폴트 라우터, 디폴트 게이트웨이` 등 외부로 나가는 선은 보통 1개로 정해져 있음

## 2. 라우팅 프로토콜과 거리벡터 라우팅

- 라우팅 : 패킷을 전달하는 경로를 선택하는 과정
	- 라우터 : 라우팅을 전문으로 하는 장치
	- 라우터는 라우팅 프로토콜로 라우팅 테이블을 만듦

- `정적 라우팅 테이블` : 직접 입력
	- 자동으로 갱신 x, 보통 호스트 컴퓨터에서 사용함 
	- LAN의 호스트는 외부 인터넷 출구가 1개라서 동적으로 구성할 필요가 없다.

- `동적 라우팅 테이블` 
	- 경로를 주기적으로 갱신함(by `라우팅 프로토콜`)
	- `RIP`, `OSPF`, `BGP`가 있음

- `유니캐스트 라우팅 프로토콜`
	- 일반적인 라우팅 프로토콜 : 목적지가 1개
	- 경로를 선택하기 위해 어떻게 라우팅 정보를 교환해서 라우팅 테이블을 구축할 것인가를 명시
	- 송수신이 모두 하나의 시스템 

- `멀티캐스트 라우팅 프로토콜`
	- 목적지가 동일 그룹에 속한 여러 호스트가 될 수 있음

### 자율 시스템(AS: Autonomous System)
- 1개의 라우팅 프로토콜이 전체 인터넷에서 통용되지 않음
- AS는 **하나의 기관** 내부를 나타낸 것으로 네트워크와 라우터의 집합으로 구성됨
- **라우팅 테이블을 주고받는 범위를 한정**하기 위해 도입됨
- `AS` 번호가 같은 라우터들만 라우팅 정보를 주고 받는다.
	- EX) 성대의 AS 숫자는 9686

- AS 내에서 주고 받는 라우팅 프로토콜이 있고, AS 간에 주고 받는 라우팅 프로토콜이 따로 있다.
	- `내부 게이트웨이 프로토콜(IGP : Interior Gateway Protocol)`
		- AS 내부에서 사용되는 라우팅 프로토콜(IS-IS, OSPF, IGRP, EIGRP, RIP 등)
	- `외부 게이트웨이 프로토콜(EGP : Exterior Gateway Protocol`
		- AS 간에 사용되는 프로토콜 (`BGP`)

- IGP는 기관마다 달라도 상관 없음 & 복수 개 사용 가능 
- EGP는 통일되어야 함(전체적인 라우팅이 필요하기 때문)

![[Pasted image 20221223155722.png]]

#### 1. 거리벡터라우팅(Distance Vector Routing)
- 두 노드 사이의 최소 비용 경로는 최소 거리를 갖는 경로
	- 경로 계산을 위해 `Bellman-Ford` 알고리즘을 사용함 
	- `RIPv1/v2`, `IGRP`
	- `BGP`도 개념 상 이것과 유사함

> 원리
> 1. 각 라우터는 자신의 정보를 이웃 라우터와 공유 
>> 초기에 각 라우터는 이웃하지 않은 라우터를 알 수 없음
>2. (다시) 1을 진행함
>> 이웃하지 않은 라우터이더라도 2번의 이동거리 내에 있는 라우터들을 알 수 있게 됨
> 즉 **자신이 가진 정보를 이웃한 라우터와 계속 교환**하는 게 핵심임

![[Pasted image 20221223160205.png]]
- A->E를 생각해보면 계속 최솟값을 유지하는 알고리즘임 (이거 코테 공부할 때 해본 적 있을 걸?)

![[Pasted image 20221223160802.png]]
- (이런 식으로 어떤 테이블로 가는 값 + 그 테이블에서 다른 노드로 가는 값들) 테이블 과 기존 테이블의 각 행에 대해 값을 비교하고 최솟값을 갱신해나가는 방식임