# 참고
- **옵시디언으로 봐야 제대로 보인다.**
	- **옵시디언으로 작성된 만큼 깃허브의 마크다운에서는 지원하지 않는 기능들이 있을 수 있다.** `[[]]`, 이미지 첨부 방식 등이 대표적.
- `[[]]` 링크는 `유니티/보관함`이나 `작업 일지/직접 작성/일지`에 대부분 있다.
---
# 작업 내용 : 짭명방

## 보고 참고할 내용
- [[오퍼레이터들 스탯 정리]]
- [[적 스탯 정리]]
- [[프로크리에이트로 텍스쳐 작업 시 유의할 점]]
## 사용 툴
- `Unity`
- UI 이미지 제작 : `Procreate`
- `VFX` 제작 사용 툴(강의 보고 따라했거나 직접 만듦)
	- 텍스쳐 제작 : `Procreate` / `Krita`
	- 메쉬 제작 : `Blender`

## 하고 싶은데 못한 것
- 2D로 오브젝트들 구현하기
	- 직접 하려면 배워서 할 수는 있겠지만 시간이 문제겠다. 
- 도전과제 구현
- 인게임 / 다른 패널에서 스킬 범위 보여주기 
	- 일관성 때문에 다른 곳에서도 구현을 해보고는 싶은데, 일단 보류.
	- 현재는 정예화 패널에서만 스킬 범위를 볼 수 있음.

---
# 작업 일지

## 짭명방 

### 남은 내용

>[!todo]
>- 남은 작업
>	- 스테이지들 만지기 : 스테이지마다 특징을 부여하면 좋을 듯?
>		- `1-0`은 튜토리얼 개념
>		- `1-1`은 바리케이드를 통한 진로 변경
>		- `1-2`는 여러 종류의 적을 보여줌(방어력 강화, 저지 무시) 
>		- `1-3`은 앞에서 배운 것들 활용 + 보스 출현
>- 테스트 중 제대로 나타나지 않는 머티리얼들 수정
>- 테스트 중 발생하는 이슈/오류 수정
>- 눈에 보이는 개선이 필요한 사항 수정
>	- 소리 추가
>- 기타 이슈들 수정

### 현재 진행 중
>[!wip]
>- 씬 변경 과정에서의 부드러운 화면 전환
>	- 스테이지 결과 패널에서 버튼 클릭 시 페이드 아웃 후에 로비로 돌아가도록 구현
>	- <막힘> 패널 인스턴스화까지는 되는데 애니메이션이 동작하지 않는 듯 : 검게 변하지 않는 상태임

- `Todo` 내용 작업 진행
### 간헐적인 이슈
- 이슈가 있다고 느꼈는데 다시 테스트했을 때 재현이 안된 것들을 정리함

# 251104 - 짭명방

>[!wip]
>1. 스테이지 씬 -> 메인메뉴 씬 전환
>2. 기타 수정
>	- `vfx_hit_explode_v1` : 늦게 떨어지는 파티클들이 어색해보임

## 스테이지 씬 -> 메인메뉴 씬 장면 전환
- 똑같이 페이드아웃 후 메인 화면 나타나도록 하면 됨

- **아예 `StageLoader`를 `SceneLoader`로 변경함**
	- 씬 전환 과정을 처리
	- 단 스테이지 로딩 화면과 메인 메뉴로 돌아가는 화면은 달라질 듯
- `StageLoadingScreen`도 `LoadingScreen`으로 변경
	- 초기화 메서드를 2개로 구현한다
		- 기존의 `stageId, stageName`이 있는 방식과 아무 파라미터도 전달하지 않는 방식

> [!info]
> **메서드 이름에 관한 고민**을 해봄
> 	1. `Initialize(param1 param)`과 `Initialize()`
> 	2. `InitializeForPurpose(param1 param)`과 `Initialize()`
> 
> 더 권장되는 방법은 1번이라고 함 - **메서드 이름에 목적이 들어가는 게 권장되진 않음**
> - **메서드 이름은 "무엇을 하는가"에만 초점**을 맞추는 게 좋다. "어떻게 하는가" 혹은 "어떤 목적을 위해 작성되었는가" 등이 들어가면 **비슷한 기능의 메서드가 다른 이름으로 계속 늘어나게 된다.** 
> - 대표적인 예시가 `Debug.Log()`인데, 이 메서드는 `string, int, Vector3` 모두 같은 메서드 이름으로 처리한다. 
> 	- 만약 내가 고민한 2번 방법대로 처리한다면 `Debug.LogString()`, `Debug.LogInt()`, `Debug.LogVector3()` 같이 똑같은 기능을 수행함에도 타입이 달라진다는 이유로 다른 메서드가 있다는 걸 알아야 함. 
> - **개발자가 기억할 메서드의 이름이 적을수록 좋다.**
> 
> - 물론 명백히 다른 기능을 수행한다면 메서드 이름을 구분하는 게 좋다. `FadeIn`, `FadeOut`같이 명확히 차이가 있는 기능을 굳이 `DoScreenEffect(EffectType.FadeIn)` 같은 느낌으로 하나의 메서드로 처리하는 건 오히려 가독성을 해칠 수 있다. 

>[!conclusion]
>- 따라서 `StageLoadingScreen`의 경우, 
>	- **`Initialize()`** :  스테이지 로딩 화면에 필요한 정보들인 스테이지 ID, 이름을 불러오지 않고 **검은 화면의 페이드인만 처리**하는 방식
>	- **`Initialize(stageId, stageName)`** : **스테이지 정보들과 로딩 게이지를 함께 보여주는 방식**

> - 일단 `SceneLoader`에서 다른 씬으로 전환하는 방식으로 메서드 수정은 완료 
> - 스테이지 -> 메인메뉴로 돌아갈 때의 페이드인은 나타나지 않고 있음
- `SceneLoader`에서 페이드인이 진행되고, 완료됐을 때 플래그 상태값이 초기화되지 않은 이슈였던 걸로 보임

- **근데 화면이 안 나타난다.** 전환마다 패널을 인스턴스화하는 방식인데, 애니메이션이 동작하지 않는 건가?

> 일단 여기까지 진행

## 기타 수정 사항 
### VFX_Hit_Explode_v1 수정
- 텍스쳐 시트로 바꾸고 나서 `Beam`의 텍스쳐인 18번을 써야 하는데 6번을 쓰고 있었다. `Impact`인데, 작아서 티가 안났음
- 파티클의 타이밍이 이상해보여서 수정.





# 251103 - 짭명방

## 스테이지 진입 버튼 누를 때 장면 전환
- 스테이지 시작 버튼을 누르면 **화면이 완전히 어두워진 다음에 로딩화면이 나타나도록** 수정

> 1. 처음에는 별도의 `FadeScreen`을 만드는 방식으로 접근
> 	- 이 방법이 겉으로 봤을 때는 가장 깔끔해보인다. `스테이지 진입 버튼 클릭 -> 화면 페이드아웃 -> 스테이지 로딩 현황 -> 완료 -> 스테이지 진입` 과정이 크게 거슬리지 않고 깔끔하게 보임
> 	- 근데 `StageLoadingScreen`이랑 일일이 설정을 맞춰야 하는 번거로움이 있는 듯.
> 2. `StageLoadingScreen`으로 통합해서 진행할 수 있을 것 같아서 다시 접근
> 	- 현재까지는 로딩 패널이 씬 전환 후에 나타나서 페이드 아웃/인이 이상함

>[!objective]
>1. 스테이지 진입 버튼을 누르면 페이드 아웃됨
>2. 씬 로딩을 시작하면 검은 화면에 스테이지 로딩 화면이 나타남
>3. 스테이지 로딩이 완료되면 완료 표시가 나온 후 1초 후에 게임이 시작되며 로딩 패널이 페이드아웃됨

### 해결
- 페이드 인이 완료되는 시점까지 로딩을 막는 방식. `yield return new WaitUntil()`

- `StageLoader.cs`
```cs
private IEnumerator LoadStage()
{
	// ...
	
	// 로딩 화면 보여주기 및 입력 차단
	ShowLoadingScreen();

	// 페이드 인 완료 이벤트를 구독함
	// 메서드는 bool 필드를 true로 바꿔주는 단순한 역할
	if (loadingScreen != null) loadingScreen.OnFadeInCompleted += HandleFadeInComplete;

	// 페이드 인 완료까지 대기
	yield return new WaitUntil(() => isFadeInCompleted);

	// 이벤트 구독 해제
	if (loadingScreen != null) loadingScreen.OnFadeInCompleted -= HandleFadeInComplete;
	
	// ...
}
```

- `StageLoadingScreen.cs`
```cs
public event Action OnFadeInCompleted = delegate { }; // 이 스크린의 페이드인 동작이 완료되었을 때 발생

public void Initialize(string stageId, string stageName)
{
	// ...
	
	// 어두운 패널이 서서히 나타남 - Append 개념은 순차적으로 동작함
	currentSequence = DOTween.Sequence();
	currentSequence.Append(screenFader.DOFade(1f, fadeOutDuration))
		.OnComplete(() =>
		{
			// 이 패널이 완전히 나타난 후 이벤트 발생
			OnFadeInCompleted?.Invoke();
		});
	currentSequence.AppendCallback(() =>
	{
		infoPanel.alpha = 1f;
	});
	
	// ...
}
```

### 기타 이슈
 - [x] 2번째 스테이지 진입부터는 `StageLoadingScreen`이 원하는 대로 동작하지 않음
	- [x] 로딩 화면이 페이드인되지 않음 : `StageLoader`의 상태 이슈
	- [x] 로딩 화면 현황이 텍스트로 나타나지 않음 
		- 해결 시도들
			1) 캔버스 강제 업데이트 - 해결 X
				- 로그를 찍어보면 값들은 제대로 나타나고 있음. 
			2) ★ `LoadingScreen`이 실행 시마다 생성되는 현상과 연관이 있을 듯 해서 그 문제부터 접근
				- `LoadingScreen`을 생성하는 부분은 `LoadStage` 내부로 통합
		- `DontDestroyOnLoad`에 `LoadingScreen`이 쌓이는 현상
			- 이것도 해결됨 - 로딩 화면의 게이지가 업데이트되지 않고 텍스트도 나타나지 않는 현상은 이것과 직접적으로 관계가 있었음
- [x] 스테이지 진입은 되는데 여러 UI가 초기화가 제대로 안 됨
	- 로딩 시퀀스 정리
		- `StageLoadingScreen`과 `StageManager`의 타이밍들을 정리할 필요가 있어보인다. 다시 봤을 때 구조가 헷갈림.
			1. `StageLoader` - `loadingScreen`을 초기화함
			2. 초기화가 완료될 때까지 `StageLoader`에서는 대기.
				- 참고) `asyncLoad.isDone`이 `true`라면 새로운 씬의 활성 오브젝트의 모든 `Awake`까지 실행됐다는 얘기임
					- [[Unity - 씬 전환]] 참고
	- 시퀀스 정리는 됐는데 UI 초기화가 안된다. 적의 전체 수라든가, 배치 가능한 횟수라든가.
		- 이건 타이밍 문제 - `StageManager`에 값들이 할당된 다음에 `UI`로 전달해야 하는데 `UI` 초기화 시점이 `StageManager`의 변수 초기화 시점보다 앞서 있었음.

---
# 이전 일지

- 깃허브 링크는 향후 프로젝트 폴더 링크 이동에 따라 손상될 수 있음
- 이 경우 대부분 `4.Archive` 폴더에서 볼 수 있다.
## 짭명방
- [짭명방 프로젝트 일지 깃허브 링크](https://github.com/dowrave/TIL/tree/main/Obsidian/1.%20Projects%2C%20Ongoing/%EC%9C%A0%EB%8B%88%ED%8B%B0%20-%20%EC%9E%91%EC%9D%80%20%EB%AA%85%EB%B0%A9%20%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0/%EC%9E%91%EC%97%85%20%EC%9D%BC%EC%A7%80/%EC%A7%81%EC%A0%91%20%EC%9E%91%EC%84%B1)
- 옵시디언 링크
	- [[24년 7월]]
	- [[24년 8월]]
	- [[24년 9월]]
	- [[24년 10월]]
	- [[24년 11월]]
	- [[24년 12월]]
	- [[25년 1월]]
	- [[25년 2월]]
	- [[25년 3월]]
	- [[1. Projects, Ongoing/유니티 - 작은 명방 구현하기/작업 일지/직접 작성/25년 4월|25년 4월]]
	- [[1. Projects, Ongoing/유니티 - 작은 명방 구현하기/작업 일지/직접 작성/25년 5월|25년 5월]]
	- [[짭명방_25년 6월]]
	- [[짭명방_25년 7월]]
	- [[짭명방_25년 8월]]
	- [[짭명방_25년 9월]]
	- [[짭명방_25년 10월]]
## 블로그
- [React + Django 프로젝트 일지 월별 작업 기록 깃허브 링크](https://github.com/dowrave/TIL/tree/main/Obsidian/1.%20Projects%2C%20Ongoing/%ED%8F%AC%ED%8F%B4%20%EA%B2%B8%20%EB%B8%94%EB%A1%9C%EA%B7%B8%20%EB%A7%8C%EB%93%A4%EA%B8%B0/%EC%9B%94%EB%B3%84%20%EC%9E%91%EC%97%85%20%EA%B8%B0%EB%A1%9D)
- 옵시디언 링크
	- [[23년 12월]]
	- [[24년 1월]]
	- [[24년 2월]]
	- [[24년 3월]]
	- [[24년 4월]]
	- [[24년 5월]]
	- [[1. Projects, Ongoing/블로그 만들기/월별 작업 기록/25년 4월|25년 4월]]
	- [[1. Projects, Ongoing/블로그 만들기/월별 작업 기록/25년 5월|25년 5월]]
	- [[블로그_25년 6월|블로그_25년 6월]]
	- [[블로그_25년 7월]]