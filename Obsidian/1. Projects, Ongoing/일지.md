- `240808~` : **Claude AI를 이용한 뒤에 대화가 너무 길어지거나 다른 내용으로 바꾸려고 하면 마지막에 지금까지 한 내용을 정리해달라는 식으로 넣겠음** 
	- 여기에 직접 정리하지 못하는 내용들은 거기에 들어간다. 물론 다 반영 안될 수 있음. AI가 던져준 코드를 쓰는 대신 다른 코드를 쓸 수도 있기 때문에!

# 앞으로 구현할 거 정리

## 유사 명방
- 게임적인 목표
	- 스테이지 : `1-1 ~ 1-3` 까지 구현하기
	- **최소 8명**의 오퍼레이터 구현 (스킬도 일단은 1개씩만 구현)
- 시스템 관련
	- 경로
		- 지금 하는 a* 알고리즘이 아니라 개발자가 직접 설정할 수 있어야 함
		- 즉 Spawner는 적의 종류, 적이 생성되는 시간을 갖고 있어야 함
			- 여기서 생성되는 Enemy는 자신의 경로를 갖고 있어야 함 
			- 상대 경로로 들어갈지 그리드 좌표로 일일이 넣을지는 그 때 가서 생각해보자.
	- `OperatorManager`에서 받는 오퍼레이터들의 정보는, 이전 씬에서 가져와야 함(이를 `편성 씬`이라고 하자)
	- 육성 요소 추가
		- 스테이지를 저런 식으로 구현할 거면, `레벨업 재화`를 1-1 시작 전에 얼마를 주고, 스테이지를 클리어할 때마다 `레벨업 재화`를 오퍼레이터에게 사용해서 육성을 시키게끔 구현하는 것도 괜찮을 듯(어떤 오퍼레이터에게 사용할지는 유저가 정하는 방식, **한정된 재화를 어떻게 사용할 것인가?**)
		- 오퍼레이터가 특정 레벨에 도달하면 재능(패시브)을 얻게 하거나 또다른 액티브 스킬을 얻게 하는 방식도 넣어볼 만 하겠다.



## 블로그
- 데이터가 제때 수집되고 있는지 눈팅 정도만 하면 충분할 것 같다.
- 사실 Quill을 쓰면서 되돌리기 / 붙여넣기 기능이 좀 이상하게 작동하고 있는 문제가 있긴 한데... 언제 해결할지는 모르겠음?

## 현재 발생 중인 문제


# 9월

## 240902
[[240902 정리]]
### 유사 명방
- 오퍼레이터 배치 시, 몇몇 하이라이트된 타일에 배치가 불가능한 문제 수정 
	- 예전에 맵을 수정한 적이 있었는데, 거기서 새로운 타일을 생성한 경우, 해당 타일이 하이라이트되지만 그 위에 스냅핑이 되지는 않는다.
	- `OperatorManager.cs`를 살펴보면 `GetHoveredTile` 메서드에서
```cs
    private Tile GetHoveredTile()
    {
        Ray ray = Camera.main.ScreenPointToRay(Input.mousePosition);
        RaycastHit hit;

        if (Physics.Raycast(ray, out hit, Mathf.Infinity, tileLayerMask))
        {
            return hit.collider.GetComponentInParent<Tile>();
        }

        return null; 
    }
```
> 위와 같음. 즉, `tileLayerMask`라는 레이어를 레이캐스트로 검사한다.
- 실제로 새로 에디터로 만든 타일들에는 `Tile` 레이어가 할당되어 있지 않다. 하이라이트 자체는 잘 작동함.
	- 따라서 타일이 생성될 때 레이어에 `타일` 레이어를 지정하는 것만으로 충분함

- `Map.cs`의 메서드 이름 수정 : 기존엔 메서드의 역할이 불분명하거나 이름만으로 어떤 기능을 하는지 직관적으로 파악하는 게 어려웠음

- 오퍼레이터 배치 동작 시 시간이 느려졌다가 원상복구될 때, 2배속임에도 1배속으로 돌아오는 현상 수정, `OperatorManager`에 있는 시간 관리 메서드들을 `StageManager`로 통합

- 일단 보이는 문제는 다 처리한 듯?

#### 경로 설정하기
- 기존엔 `PathfindingManager`를 이용해서 최단 경로를 찾는 알고리즘으로 구현했다.
- 그런데 실제 명방을 보면, 어떤 위치에서 몇 초 쉰다든가, 아니면 빙글빙글 돈다든가 하는 식으로 개발자가 직접 경로를 설정하는 것으로 보이는 예시가 많았다.
- 그래서 이번엔 경로를 직접 설정하는 방식을 구현해보려고 함.
- 아예 `ScriptableObject`에 `PathData`를 만들고, 여기에 유니티 엔진 상에서 씬 뷰를 클릭해서 해당 타일을 경로에 넣는 방식으로 직접 편집할 수 있게끔 구현하고 있다. 
- 그런데 `Tile` 레이어로 설정하면 `Scene` 뷰에서는 안 보이는데 `Game` 뷰에서는 보이는 문제가 있다. ???? `Culling Mask` 이슈도 아니다.
	- 그냥 `Tile` 레이어를 옮겼다. 나중에 충돌이 나는 사안이 있다면 그때 보자.
- 대기 시간도 설정을 한 상태인데, 대기가 끝나면 다음 노드로 옮겨야 하는데 그러지 못하고 그 자리에서 그대로 끝나버리는 현상이 있었다
	- 인덱스만 잘 추적시켜 놓으면 된다. 


## 240901

### 유사 명방
- 공격 범위에서 적이 벗어나도 계속 공격하는 문제 해결
- `StageManager`에서 `UIManager` 의 역할을 하는 부분을 `UIManager`로 옮김
- 사실 원래 계획은 버튼의 클릭 이벤트가 마우스 버튼다운 때 1번, 마우스 버튼 업 때 1번 총 2번 발생하는 걸 해결하려는 계획이었는데, 정작 이건 해결 못하고 있음.
	- **`ClickDetectionSystem`과의 충돌 때문 아닐까??** 실제로 `MouseButtonDown` 때 `HandleClick` 메서드가 발동되도록 하고 있다.
	- `MouseButtonDown`과 `Click`을 구분했다.

- 머릿속으로 생각하려니 계속 헷갈려서 동작을 정리함 : [[마우스버튼다운, 클릭 동작 정리]]
	- 문제 자체는 해결됐다. 근데 갈수록 스파게티 코드가 되고 있는 것 같다..
	- 며칠 동안 헤맨 문제여서 해결한 것에 의의를 둬야겠음.

- `Button` 컴포넌트의 `OnClick`의 경우, 별도로 구현하지 않더라도 유니티의 UI 시스템에 의해 기본적으로 동작한다. 따라서 `ClickDetctionSystem`에서 굳이 별도로 `onClick.Invoke()`를 구현할 필요는 없다. 이거 구현하면 2번 실행됨.

