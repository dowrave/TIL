#Unity 

- 언어에 따른 텍스트들은 어떻게 관리하는지 궁금해서 정리해둠
- 유니티에서 지원하는 `Localization`이라는 패키지가 있다. 이걸 사용하는 편이 훨씬 나음

### 1. 언어 버전 관리
- `GameManagement`에 `_currentLanguage` 및 `enum` 타입의 `Language` 생성

```cs
// 1. 언어 종류를 Enum으로 관리 (확장성 및 가독성)
public enum Language
{
	English,
	Korean,
	Japanese,
	// 필요에 따라 언어 추가
}

// 2. 현재 언어 설정
private Language _currentLanguage = Language.English; // 기본값
public Language CurrentLanguage
{
	get => _currentLanguage;
	set
	{
		if (_currentLanguage != value)
		{
			_currentLanguage = value;
			// 언어가 변경되었음을 알리는 이벤트 발생
			OnLanguageChanged?.Invoke();
		}
	}
}

// 3. 언어 변경 시 다른 객체들에게 알리기 위한 이벤트
public event Action OnLanguageChanged;
```

### 2. 여러 언어에 따른 텍스트 데이터 저장
#### 1. 클래스 구현
```cs
[System.Serializable]
public class LocalizationItem
{
	public string key; // 텍스트를 식별할 고유 키('entity_name_player', 'ui_button_start' 등)
	public string[] translations; // 언어 순서에 맞춘 번역된 텍스트 배열
	// Language 순서에 맞춰서 들어가야 한다
}
```


#### 2. 언어 테이블 SO
```cs
using UnityEngine;
using System.Collections.Generic;

[CreateAssetMenu(fileName = "LocalizationTable", menuName = "Localization/Localization Table")]
public class LocalizationTableSO : ScriptableObject
{
    // GameManagement의 Language enum 순서와 반드시 일치해야 함
    // [English, Korean, Japanese, ...]
    public List<LocalizationItem> items;
}
```

#### 3. 텍스트를 가져오는 관리자
- `GameManagement`의 하위 오브젝트로 구현하는 걸 추천
- 다 옮기면 번거로우니 핵심 요소만 표시
```cs
public class LocalizationManager: MonoBehaviour 
{
	private void Start() 
	{
		GameManagement.Instance.OnLanguageChanged += LoadLanguage;
		LoadLanguage(); // 게임 시작 시 현재 언어의 텍스트 로드
	}
	
	private void LoadLanguage() 
	{
        _currentLanguageTexts = new Dictionary<string, string>();
        int languageIndex = (int)GameManagement.Instance.CurrentLanguage;

        foreach (var item in localizationTable.items)
        {
            // 키가 중복되지 않도록 주의
            if (!_currentLanguageTexts.ContainsKey(item.key))
            {
                // 현재 언어 인덱스에 맞는 번역문을 가져옴
                if (item.translations.Length > languageIndex)
                {
                    _currentLanguageTexts.Add(item.key, item.translations[languageIndex]);
                }
                else
                {
                    Debug.LogWarning($"Key '{item.key}' 에 대한 번역이 없습니다. (언어: {GameManagement.Instance.CurrentLanguage})");
                    _currentLanguageTexts.Add(item.key, item.key); // 번역이 없으면 키를 대신 표시
                }
            }
        }
        Debug.Log($"{GameManagement.Instance.CurrentLanguage} 언어 로드 완료.");
	}

    // 외부에서 텍스트를 가져갈 때 사용하는 함수
    public string GetText(string key)
    {
        if (_currentLanguageTexts.TryGetValue(key, out string value))
        {
            return value;
        }

        Debug.LogError($"Localization key not found: {key}");
        return key; // 키를 찾지 못하면 키 값을 그대로 반환
    }
}
```

#### 4. 실제 사용
- 예를 들어서 지금 `entityName`을 바꾸고 싶은 상태라면
```cs
	public string entityName;
```

이거 대신에
```cs
// SO에는 이렇게 저장
public string entityNameKey; // LocalizationItem에서 관리되는 "키" 값을 가져옴

// 실제 사용할 때는 아래처럼 불러옴
nameText.text = LocalizationManager.Instance.GetText(entityData.entityGameKey);
```

#### 5. 인게임에서 언어 변경했을 경우
- `TMP`가 달린 텍스트에 `GameManagement`에서 발생하는 `_currentLanguage` 변화 이벤트 기반의 언어 변경 스크립트를 붙여야 함
- 이 부분까지는 구현하지 않을 것 같아서 유지

