- [[번개 이펙트 구현하기(ㄴㄴ)]] 부분을 끝까지 따라가 봤음
- 그런데 `Plane`에 셰이더 그래프를 올리는 방식으로 구현했을 경우 카메라 각도에 따라서 의도치 않은 상황들이 발생함
	- 똑같이 카메라 로테이션이 잡혔는데도 이상하게 인게임에서는 `Plane`이 눕는 형태가 나타났다. `Orient : Face Camera Plane` 등도 제대로 동작하지 않았음.
- 따라서, 같은 사람이 더 최근에 올린 [이 영상](https://www.youtube.com/watch?v=XPh0jiqf0iQ&t=186s)을 따라가도록 한다.

## VFX 그래프
- 싱글 버스트
- 라이프타임 1초
- 사이즈 1

## 텍스쳐 만들기 - Krita
- `Material Maker`도 사용할 수 있음! 여기선 기본적인 텍스쳐를 만듦
- `2048 x 2048`
- `Airbrush - soft`
- `Shift + W`를 누르면 `Wrap Mode` 활성화. 경계선이 없는 텍스쳐를 만들 수 있음

![[Pasted image 20250102204504.png]]

- 대충 이런 느낌의 그림을 만들면 됨, 저장할 때는 **검은 배경은 제거**
레이어 1 - 흰 선을 그리고 지우개로 조금씩 지워줌
레이어 2 - 흰 선을 감싸는 블러 느낌을 구현함. 수제 블러.

- **검은 배경 없이, 2개의 레이어를 각각 별도로 저장**(Export, 내보내기)함.

- 캡슐에 반영한 결과(씬 뷰, `Shaded Wireframe`)
![[Pasted image 20250102205132.png]]

## Blender - 메쉬 구현 
- 기존 도형 제거 후 `Shift + a - Curve - Bezier`
- `r` : 회전 및 `y`를 눌러서 `xy` 평면에 수직한 방향으로 세움
- `g` + `z`로 곡선의 가장 아래가 `xy` 평면에 오게 이동
- `Tab`으로 `Edit Mode`로 변경, 위쪽의 버텍스를 잡고 `g` + `z`로 위로 늘림
- `Shift + 클릭`으로 위, 아래 노드를 잡고 우클릭 - `SubDivide`으로 중간에 새로운 `Vertex`를 만듦
	- 이 과정을 한 두 번 정도만 반복해서 아래처럼 모양을 만듦
![[Pasted image 20250102210157.png]]

- 우측 하단 초록색 선 모양인 `BezierCurve` - `Geometry` - `Extrude` 값을 `0.7m` 정도 줌
- 같은 탭 상단의 `Shape - Resolution Preview`를 `3~4` 정도로 수정

![[Pasted image 20250102210715.png]]

- `Object Mode`로 돌아와서 `Layout - Object - Convert To Mesh`
	- 우측 상단에 기존 `Bezier Curve` 아이콘이 삼각형으로 바뀌었으면 ㅇㅋ

- UV Map 만들기
	- 왼쪽에서 탭 새로 꺼냄 -> 상단 `UV Editing` 클릭
	- `Tab`으로 `Edit Mode`으로 전환, 좌측 상단의 `UV Sync Selection` 클릭
	- 상단의 2개 버텍스를 잡았을 때, 화면의 왼쪽이 활성화되면 ㅇㅋ
	- 만약 상단의 2개 버텍스가 오른쪽이라면 UV Map에서 전체에 `R`을 누르고 180도 돌리면 됨

- 상단을 두껍게, 하단을 얇게 만들기
	- `Edit Mode`활성화, 상단의 `Proportional Editing(이나 단축키 O)` 클릭
	- 상단의 노드를 잡고 S 키를 누르면 동그라미가 나타남. 스크롤 업/다운으로 스케일링 할 수 있는 범위 지정 가능
	- 그래서 윗부분은 두껍게, 아랫부분은 얇게 만들면 됨

![[Pasted image 20250102212243.png]]

- 최하단 2개의 Vertex 클릭 -> `Shift + S` -> `Cursor To Selected` 설정
- `Object Mode`로 전환, 상단의 `Object - Set Origin - Origin to 3D Cursor` 설정
- 위 두 줄은 **가장 마지막의 두 버텍스를 피벗으로 설정해서 스케일 업/다운하는 기준점**을 만든 것

- `Export - FBX`로 저장



## 유니티 - VFX 그래프

- 유니티로 위 모델을 옮긴 뒤 **`Scale Factor`을 100으로 설정**
	- `100`으로 설정하는 이유는 유니티 유닛과 단위를 맞추기 위함

- 그냥 넣으면 기본적으로 눕기 때문에 `Initialize - Set Angle`로 적절한 각도 설정
- **`Output Particle`을 클릭**하면 인스펙터에서 **`Cull Mode`가 있는데, 이를 `Off`로 설정하면 양쪽 면 모두에서 볼 수 있다.**

> 이전 과정에서 아쉬울 수 있는 거
> 1. 폴리곤이 적다 : 블렌더에서 `Edit Mode - Ctrl + R`로 폴리곤을 추가할 수 있음
> 2. 번개 줄기가 너무 가늘다 : 크리타에서 기존 두 레이어를 지정한 다음 `ctrl + G`로 그룹화 -> `ctrl + t`를 눌러서 영역을 잡고 두께를 키울 수 있음. 
> 	- 영역이 지정된 상태에서 `Alt`를 누른채로 드래그하면 피벗을 유지할 수 있음

- 이렇게 기존 파티클에 메쉬까지 부여해서 번개 모양을 하나 만들었다면, 블러 텍스쳐를 할당한 `Output Particle Mesh`를 하나 더 만든다
	- 이 때 렌더링 순서는 블러가 먼저, 기존 구현이 나중이다. 파일에서 블러를 먼저 렌더링하도록 순서를 바꾼다. 
![[Pasted image 20250102215415.png]]![[Pasted image 20250102215435.png]]

- 셰이더 그래프 설정
- 알파 클립 역할만을 하는 단순한 디졸브 셰이더 구현
- `URP - Unlit Shader Graph`
	- `Active Targets`에  `Visual Effect` 할당, `Universal` 제거
	- `Alpha Clipping` 체크

- 셰이더 그래프는 가장 기본적인 그 구현임
	1. `SampleTexture2D * Color`
		=> `Base Color`
		=> `Split (Alpha)` => `Alpha`
	2. 추가로, 프로퍼티로 `Clip`을 `Slider`로 설정

- 위에서 설정한 셰이더 그래프를 할당하면 이런 느낌으로 나옴
![[Pasted image 20250102220533.png]]
> 클립 0일 때

![[Pasted image 20250102220556.png]]
> 클립 0.7일 때

- 보이듯, 크리타에서 텍스쳐에 더 다양한 알파값이 들어간다면 더 다채로운 효과가 나올 거임

- `Age Over Lifetime + Sample Curve`를 구현
- 커브 모양은 ![[Pasted image 20250102220825.png]] 이런 느낌임. 
	- 가운데에 2개의 키를 만들고 동시에 지정한 뒤 드래그해서 한꺼번에 내릴 수 있다.
	- 이 값을 Clip에 지정하면, 굵은 선이 처음에는 없다가 나타났다가 사라지는 식으로 효과가 나타날 거임

- 색깔 구현
	- 깜빡인 다음에 나타나는 식의 구현을 할 거임
![[Pasted image 20250102221517.png]]
- 위의 그래디언트를 `Sample Gradient`에 넣고, `Age Over Lifetime`에 연결, 이 값을 `Color`에 연결한다

- 오른쪽의 블러에 관한 `Output Particle Mesh`에도 색깔에 관한 그래디언트를 연결해준다.
	- 이 때, 그래디언트의 오른쪽 부분의 `Intensity`를 0으로 설정해주면 더 이쁜 번개가 나온다.


- 여기까지만 해도 기본적인 구현은 다 된 거고, 이 아래는 추가적인 내용

1. `Initialize Particle` 부분부터 복사해서, 블러 부분에 붙임. 
	- `Set Lifetime`을 더 오래 설정
	- 즉 기존엔 `Update`에서 분화되었다면 지금은 `Spawn` 이후에 분화됨
	- **블러를 더 오래 남기기 위한 구현**

2. `Spawn`에서 `SingleBurst`를 하나 더 만듦. `Delay`를 0.15로 설정함
	- **블링크 효과. 즉 2번씩 점멸된다.**

3.  스크롤 효과
	- 셰이더 그래프 - Tiling And Offset에서 `Offset`에 `Vector2` 프로퍼티 설정 후 `MainTex2D`의 `UV`에 연결
	- VFX 그래프 - `Sample Curve` 설정 -> 위에서 설정한 **오프셋 프로퍼티의 X축**에 연결
	- `Sample Curve` 설정
		- 0.3초에서 0
		- 1초에서 -0.5
		- 그 사이를 아래로 볼록하도록 그래프가 이동
		- 이전에 했던 노이즈와 달리, 3차원 메쉬를 펼친 모양이기 때문에 X축에 연결하고 움직이는 방식으로만 구현하면 됨
			- 번개가 서서히 나타난다기보다는 시작점, 끝점이 동시에 나타나고 그 사이를 지지직 거리는 느낌.
	- 위에서 색깔 그래디언트를 설정했을 때, 최초에 점멸하는 부분이랑 밝게 나오는 부분이 있었다.
		- 최초 점멸 시에는 움직이지 않게
		- 나중에 점멸할 때에는 움직이도록 구현한 것

- 낮에 했던 내용이랑 이어붙여보면 이런 느낌임. 의외로 착 붙는다.
![[Pasted image 20250102223817.png]]
![[Pasted image 20250102223832.png]]

> 인게임 구현까지 확인해봄
- 카메라 앵글 때문에, 수직으로 번개가 떨어지는 경우에 카메라에는 시작점 -> 끝점으로 이쁘게 담기지 않음. 그래서 **시작점의 플래쉬는 제거**했다.

