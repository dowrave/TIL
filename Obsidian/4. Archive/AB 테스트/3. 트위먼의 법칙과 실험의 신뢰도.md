> - `트위먼의 법칙` : 흥미롭게 보이거나 다르게 보이는 모든 것들은 대체로 틀렸다.

긍정적인 결과를 보면 그것을 중심으로 이야기를 만드는 반면, 부정적일 때는 연구의 한계를 찾아내고 그것을 무시하는 경향이 있다.
**경험에 따르면 많은 극단적인 결과는 계측 오류, 데이터 손실, 중복 또는 계산 오류의 결과일 가능성이 높다.** 

## 통계 결과의 잘못된 해석

### 통계적 검증력 부족
`귀무가설 유의도 테스트Null Hypothesis Significance Testing`에서 일반적인 실수는 **지표가 통계적으로 유의하지 않다고 해서 실험 효과가 없다고 가정하는 것이다.** 실험이 우리가 보려는 효과 크기를 탐지하기에 검증력이 부족할 수 있다. 즉, 테스트에서 사용자가 부족할 수 있다. 
그렇기 때문에, 어떤 것이 중요한지 정의하고 그 크기, 혹은 더 작은 크기의 변화를 감지하기 위한 검증력을 갖췄는지 확인하는 것이 중요하다.

### p값의 잘못된 해석
p값에 관한 가장 일반적인 해석 오류는, p값이 실험군의 평균 지표 값이 대조군의 평균 지표 값과 다를 확률을 나타낸다는 믿음이다. **p값은 귀무가설을 참이라고 가정할 때 관측된 값과 같거나 더 극단적인 결과를 얻을 확률이다.** <-- 이 가설은 매우 중요하다.

> p값과 관련한 오류들 정리
> 1. p = 0.05이면 귀무가설이 참일 확률이 5%이다.
> 	- p값은 귀무가설이 참이라는 가정 하에 계산되는 값이다. 귀무가설이 참일 확률이 아님.
> 2. 유의하지 않은 차이는 그룹 간에 차이가 없음을 의미한다.
> 	-  관측 결과는 실험 효과가 0이거나 작은 값이라는 귀무가설과 일치하는 상황이다. 이 경우는 실험의 `검증력`을 살펴봐야 함.
> 3. p = 0.05는 귀무가설에서 사건의 5%만 발생하는 데이터를 관측했음을 의미한다
> 	- p값의 정의는 관찰된 값과 동일하거나 더 극단의 값을 얻을 확률이므로, 아예 틀린 말.
> 4. p = 0.05는 귀무가설 기각 시 거짓 양성 확률이 5%에 불과함을 의미한다.
> 	- ex) 납에 용액을 주입해서 금으로 바꾼다고 가정한다. 일반적인 화학 지식으로, 원자 번호를 위 방식으로 낮추는 것은 불가능하다. 따라서 p값에 관계 없이 100% `False Positive`가 된다.(예상 : 실험의 효과가 있다 -> 그럴 리가 없으니까) 
> 	- p < 0.05인데 귀무가설이 참일 확률을 계산하기 위해 `베이즈 정리`를 사용할 수 있고, 이는 `사전 확률Prior Probability`을 필요로 한다. 

### p값 엿보기
p값을 지속적으로 모니터링할 수 있다. 이럴 때 다중 가설 검정은 결과를 통계적으로 유의미하다고 선언할 때, 유의한 편향을 초래한다. 이에 대한 대안으로는
> 1. 항상 유효한 p값을 가진 순차적 시험이나 베이지안 테스트 프레임워크를 사용한다.
> 2. 통계적 유의도 결정에는 1주일과 같이 미리 정해진 실험 기간을 사용한다.  

## 다중 가정 테스트
`다중 비교 오류Multiple Comparisons Problem`는 위의 `엿보기`의 일반화다. 다중 테스트에서 가장 낮은 p값을 선택한다면, p값과 효과 크기에 대한 추정치가 편향되기 쉽다. 아래 상황에서 편향이 발생하기 쉽다.

1. 여러 지표를 살펴본다.
2. 시간 경과에 따른 p값 보기(`엿보기`)
3. 모집단의 세그먼트(국가, 브라우저 유형, 중/경, 신규/오래된)를 살펴본다.
4. 실험을 여러 번 반복하는 것을 본다. 정말로 아무 것도 하지 않는 실험(A/A 테스트)에서 p값이 우연히 0.05보다 작아질 수 있다.

- `거짓 발견 비율False Discovery Rate`은 다중 테스트를 다루는 핵심 개념이다.

## 신뢰 구간
신뢰 구간은 실험 효과의 불확실성 정도를 계량화한다. 95% 신뢰 구간은 `p값 < 0.05`을 의미한다. 
흔한 실수 중 하나는 대조군과 실험군에 대한 신뢰 구간을 별도로 살펴본 후, 중복되었다면 실험 효과가 통계적으로 다르지 않다고 가정하는 것이다. `통계적 경험 법칙`에 나타난 것처럼, 이는 부정확하다. 
또다른 오해로는 제시된 95% 신뢰 구간에 진정한 실험 효과가 포함될 확률이 95%라는 믿음이다. 한 실험에 대한 특정 신뢰구간에 대해, 실제 실험 효과가 그 구간에 포함될 확률은 100% 아니면 0%이다. `95%`의 의미는 반복된 여러 실험의 신뢰 구간들이 얼마나 많은 경우에 실제 실험 효과를 포함하는지를 나타낸다.

## 내부 유효성
`내부 유효성Internal Validity`은 다른 모집단이나 기간에 일반화를 시도하지 않고 실험 결과의 정확성을 말한다. 

### SUTVA 위반
- **`안정적 단위 실험 가치 가정SUTVA` : 실험 단위가 서로 간섭하지 않는다**
- 이들은 그들 자신의 변형 할당에 의해서만 영향을 받는데, 아래 상황에서 위반될 수 있다.

- 소셜 네트워크 : 기능이 사용자의 네트워크로 유출 가능
- P2P 호출이 SUTVA를 위반할 수 있는 스카이프
- 공동 저작 지원을 포함한 문서 작성 도구
- 양측 시장(옥션, 에어베인베, 이베이, 우버 등)은 다른 축을 통해 SUTVA를 위반할 수 있다. 실험군 가격을 낮추면, 경매를 통해 대조군에 영향을 미친다.
- 공유 자원(CPU, 스토리지, 캐시)는 SUTVA에 영향을 미칠 수 있다. 실험군의 코드가 컴퓨터에 고장을 일으킨 경우, 대조군에 있는 사용자들에게도 영향을 미칠 수 있다.

### 생존 편향
> `생존 편향`의 대표적인 예시 : 비행기에 철갑을 추가하는 위치인데, 총알 자국이 가장 많은 곳에 추가하는 게 아니라, 가장 없는 곳에 추가해야 했다. 왜냐하면 총알 자국이 없는 곳에 피탄된 비행기는 살아 돌아오지 못했기 때문이다.

일정 기간 활동한 사용자를 분석하면 생존 편향이 발생한다. 

### 실험 의도 분석
변형군에서 무작위가 아닌 방해 요소가 발생할 수 있다. 예를 들어, 의료 환경에서 실험 중인 환자는 부작용이 있다면 실험 요소인 약물을 중단할 수 있다. 
`실험 의도 분석intention to treat`은 실행되었는지 여부에 상관 없이, 초기에 나눴던 그룹에 맞춰서 분석을 실시한다. 

### 샘플 비율 불일치(SRM)
사용자 비율이 설계 비율에 근접하지 않을 경우, 실험은 `샘플 비율 불일치`를 겪는다. 
실험을 진행하면서 이 비율이 깨지는 경우 시스템은 강력한 경고를 생성하고 스코어카드와 보고서를 숨겨야 한다.  

- 아래 예시들을 보면서 익히자
> 1. 브라우저 리디렉션 : A/B 테스트를 실행하기 위한 방법 중 하나는 **실험군을 다른 페이지로 리디렉션**하는 것이다. 그러나 이는 잘못되었고, 지속적으로 SRM을 야기한다는 것을 보여준다.
	- 이유 1 : 성능 차이 - 실험군의 사용자는 추가적인 리디렉션을 경험, 수백 밀리초 차이가 나지만 이는 중요한 지표에 영향을 미칠 수 있다.
	- 이유 2 : 봇 - 로봇은 리디렉션을 다르게 처리한다. 어떤 로봇은 메타 태그를 리디렉션하지 않을 수도 있고, 다른 로봇은 더 자주 크롤링할 수도 있다.
	- 이유 3 : 리디렉션은 비대칭이다 - 실험군 페이지에 즐겨찾기나, 친구에게 실험군 페이지에 대한 링크를 전달할 수도 있다. 
> 서버 측 매커니즘이 대안이 될 수 있으며, 불가능하다면 대조군과 실험군 모두 리디렉션이 적용되어야 한다.

> 2. 손실 계측 
> - 클릭 추적에는 일반적으로 `웹 비콘`(클릭 신호를 보내기 위해 서버로 전송되는 1X1 GIF)을 사용하며, 손실(100% 클릭이 기록되지 않음)이 있는 것으로 알려져 있다. 

- 지금 쓰면서도 무슨 말을 하는지 모르겠어서 정리는 간단하게만 하고 넘기겠음

- `외부 유효성External Validity` : 종합 대조 실험의 결과가 서로 다른 모집단에 일반화될 수 있는 정도
	- ex) 다른 국가나 웹사이트에 2%의 수익 증가가 장기간 지속될 것인가, 감소할 것인가?

- `초두 효과` : 변경사항 도입에 사용자가 익숙해지기까지 시간이 필요할 수 있다.
- `신기 효과, 새로움 효과` : 처음에는 사용자의 눈길을 끌지만, 유용하지 않은 기능이라서 반복 사용량이 작아지는 경우.
	- 이 두 효과를 탐지하려면 시간에 따른 사용량을 관찰해야 함.
	- 장시간 지속 시 주의 사항이 생기는데, 뒤에서 다룸.  

### 세그먼트 차이
- 좋은 세그먼트란
	- 시장과 국가
	- 기기 또는 플랫폼
	- 하루의 시간
	- 요일
	- 사용자 유형 : 기존 / 신규 사용자 등
	- 사용자 계정 기능 : 넷플릭스의 싱글/가족 공유 계정 등

- 2가지 관점으로 사용됨 
	1. 지표
	2. 실험 맥락에서 지표의 실험 효과에 대한 세그먼트 관점 : `이질적 실험 효과Heterogeneous Treatment Effects` - 상이한 세그먼트에서 실험효과가 동질적이거나 균등하지 않음

- ex) 빙 모바일 광고의 클릭률이 모바일 OS에 따라 다르다
	- 각 모바일 OS의 충성도와 사용자 모집단 간 차이일 수 있겠다는 결론을 내렸음
	- 그런데 더 파보니까 **각 운영체제에 사용되는 클릭 추적 방법론**이 달랐음
		- iOS, Windows Phone은 리디렉션을 사용 : 클릭 -> 서버 & 로그 기록 -> 목적지 리디렉션. 정확도가 높으나 느린 방법이다
		- Android : 웹 비콘을 사용해 추적 클릭 수행되어 클릭 표시 및 목적지 페이지로 리디렉션 : 사용자에게는 빠르지만 손실률이 더 높다.
		- 또한, `Windows Phone`에는 리디렉션 시 사용자가 화면을 미는 것이 클릭으로 잘못 기록되는 버그 또한 있었다.

- 부정적이든 긍정적이든 강한 효과가 있다면, `트위먼의 법칙`을 발동해 원인을 파헤쳐야 한다.

- 흥미로운 세그먼트 식별하기 : `의사결정 트리`, `랜덤 포레스트` 등의 머신 러닝과 통계 기법으로 발견 가능.

- **`심슨의 역설` : 집단을 세그먼트로 나눠서 분석한 결과와 전체 집단을 하나로 묶어서 분석한 결과가 정반대의 결론을 내리는 현상.**
	- 예시) 학교 A와 B가 있다
	- 남녀별로 시험 성적 분석 시, A에서는 남자 > 여자이고 B에서도 남자 > 여자다.
	- 그런데 A와 B를 합쳐서 분석하면 남자 < 여자인 경우가 발생할 수 있다.
	- **단순히 둘의 높고 낮음만을 비교했을 뿐, 그 수치가 제시되지 않았다. 인원수도 영향을 줄 수 있고, 평균 성적이라는 값의 크기도 영향을 줄 수 있다.**
- 실제로 책에서 든 예시도 실험군의 사용자가 많았다는 언급이 있음
- 따라서 다른 비율로 수집된 데이터를 합산할 때에는 유의해야 한다. `확실한 것 원리Sure-Thing Principle 정리`는 어떤 행동이 각 하위 모집단에서 사건의 확률을 증가시킨다면, 모집단 전체적으로 해당 사건의 확률을 증가시켜야 한다고 명시하고 있다.