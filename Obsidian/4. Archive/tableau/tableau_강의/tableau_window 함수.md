#tableau_levelup 

- `WINDOW_AVG, WINDOW_COUNT, WINDOW_MAX, WINDOW_MIN, WINDOW_SUM`을 알면 나머지도 적절하게 쓸 수 있다
- 데이터의 분포가 상이하게 나타나는 차원값을 정규화할 때 유용함
## 1. Window
- **사용자 중심의 계산 가능한 범위**
- 이평선 애기하는 거 아님?
```TABLEAU
WINDOW_AVG(SUM[Sales], 
// FIRST(), LAST()
)
```
- 아무 인자도 설정하지 않으면 모든 바운더리에 대해 평균 값을 구함
- 중간의 `FIRST(), LAST()`부분은 있는 거나 없는 거나 똑같으며, 윈도우로 잡을 영역을 지정함

#### 시작과 끝 범위
- **`0` : 자기 자신**
- `3` : 내 위치 + 3번째에 있는 값
- `-`도 마찬가지로 나보다 앞에 있는 위치

```TABLEAU
WINDOW_AVG(SUM[Sales], 0, 3)
```
- 각 위치에 대해, `현재 위치 ~ 현재 위치 + 3`까지의 평균값을 현재 위치에 넣으라는 뜻
- 즉 4개의 데이터가 들어감

#### 값이 부족한 상황 제외하기
- 예제 따라가면서 든 의문처럼, 양쪽 끝 구간은 **데이터가 부족함 -> 그래서 표시하지 않고 싶음**
```TABLEAU
IF WINDOW_COUNT(SUM([Sales]), -1, 1) = 3
THEN WINDOW_AVG(SUM[Sales], -1, 1) END
```
- **`IF` 조건문으로 구간의 숫자를 세고 적용해달라고 만들 수 있다**

### WINDOW는 패널 범위를 무시하는가?
- 역시 커스터마이징이 가능하다
- 일단 `연도 - 분기` 불연속 데이터에 대해서 디폴트는 `테이블(옆으로)`이다. 즉 `패널`인 `연도`를 무시한다는 의미임
- 이를 `패널(옆으로)`로 바꾸면 다음 년도에 대해선 `WINDOW`가 적용되지 않음.

- 이 상태에서 다시 `IF`조건을 준다면? 2분기, 3분기에 대해서만 WINDOW 데이터가 표시될 것이다. 위에서 범위를 제한해줬기 때문.

## 2. WINDOW_USE_CASE

- **ㅈㄴ 좋은데요?**
- **INDEX()** 함수 사용 예시
- 지역에 따른 사람들의 Sales 합계를 보고 싶다
> `Region`, `합계(Sales)`를 행/열에 각각 올림
> `Customer Name`을 세부 정보에 올림
> `마크 : 원`으로 수정함
- 이 상태면 각 지역에 따라 일렬로 점이 찍힘 : 겹쳐진 영역이 잘 안보이고, 점이 큼

> 위 상태에서 행에 `INDEX()`를 추가하고 불연속으로 바꾼 뒤, `테이블 계산 편집 - Customer Name만 체크`를 설정하면 일렬로 찍힌 점들이 각 Region에 대해 가로로 펼쳐지게 됨


- 피쳐 스케일링 : `MIN-MAX NORMALIZATION`
```
(SUM([Sales]) - WINDOW_MIN(SUM([Sales]))) / 
(WINDOW_MAX(SUM([Sales])) - WINDOW_MIN(SUM([Sales])))
```

- 근데 이 상태에서도 높은 Sales 를 가진 일부 데이터 때문에 낮은 위치의 많은 데이터들이 너무 겹쳐서 나옴

- 이 때 Sales를 정규화한 특성을 넣을 수 있음
> 행에 있는 Sales를 제거하고 Normalized_Sale을 올림
> `테이블 계산 편집 - 특정 차원`에서  `Region` 해제, `Customer Name` 활성화

- 이렇게 하면 **각 지역의 최대 매출 고객을 1로 한 정규화된 Sales를 관찰**할 수 있음