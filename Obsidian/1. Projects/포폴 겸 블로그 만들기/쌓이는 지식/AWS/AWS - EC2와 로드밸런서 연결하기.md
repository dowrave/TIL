- 기본적인 로드 밸런서의 설정
	- `리스너` : 어떤 포트를 받겠다
	- `대상 그룹` : 어떤 포트로 어떤 대상(인스턴스)에 보내겠다

- 내 케이스
	- `리스너`는 https(443) 포트로 구성
	- `대상 그룹`은 https(80) 포트로 구성

## 문제 1
> - 로드밸런서의 `대상 그룹으로 전달`에서 `대상 그룹`이 `Unhealthy`로 뜨는 현상

### 해결 내용
- 앞에서 헤맸던 내용들도 정리하려 하는데 지금 갑자기 찾은 거
	- 로드밸런서의 **보안 그룹을 만들 때, 임시적으로 EC2에 관한 것으로 생성**했는데, 이걸 까먹고 있다가 갑자기 발견했다. 그래서 LB에 관한 것으로 바꿔줬음.
	- 그러자, 똑같이 대상 그룹이 Unhealthy로 뜨긴 하지만 오류의 내용이 바뀌었다. 전자는 응답 시간 초과, 후자는 `400`에러 반환.
	- `400`에러가 왔다 = 도커 컨테이너가 대답을 한 것이다

- 따라서 일단 대상 그룹의 등록을 취소 -> 컨테이너를 지웠다가 다시 띄움 -> 오류 로그 내용 파악 의 과정을 거쳤다.
- 일단 **로드밸런서에 대상 그룹이 등록되어 있으면, 지속적으로 상태 확인을 하는 것**으로 보인다. 왜냐면 컨테이너에 이런 오류가 지속적으로 떴기 때문이다.
```
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '{IP}'. You may need to add '{IP}' to ALLOWED_HOSTS.
```
- 물론 ALLOWED_HOSTS에 바로 해당 IP를 넣은 다음 이미지를 다시 빌드하면 되겠지만, IP가 바뀔 수도 있기 때문에 더 파악해봄

- 오류 내용을 파악할 수 있으면 해결이 쉬워진다. 요즘은 생성 언어 모델의 시대가 아닌가?
	- 해당 IP는 **EC2 인스턴스의 프라이빗 IP** 이다. 이는 인스턴스가 종료terminate될 때만 바뀐다니, **ALLOWED_HOSTS에 EC2 인스턴스의 IP를 넣는다.**
	- 이후로 어떻게 될 지는 모르겠지만, 로드밸런서의 도메인도 남겨놓는다.

## 문제 2
> - 문제 1을 해결했음에도, 프론트엔드에서 보내는 요청이 백엔드에 도달하지 못하는 현상

- **현상을 제대로 나타내야 한다**
	1. 루트 도메인으로 접근 후 더 깊은 도메인(`/work`, `/hobby`)으로 접근하면 다른 요소들을 백엔드에 요청하지 않음
	2. 한편 아예 처음부터 `/work`, `/hobby` 등으로 접근하면 잘 불러와짐

- **로컬이랑 서비스에서의 동작이 다르다**
	- 상위 라우트에 접근 시 서브 라우트에 있는 컴포넌트들은 마운트되지만, 반대로 옆집 상위 라우트에 접근했다면 서브라우트에 없기 때문에 마운트되지 않음
	- 이 상태에서 갑자기 옆집 하위 라우트에 접근하면, 마운트되지 않았기 때문에 `useEffect`문도 실행되지 않은 상태이고, 따라서 바로 에러가 발생한다.
	- 문제는 이런 상황이 로컬에서는 없이, 잘 작동했었다는 것이다.

- sibling 컴포넌트에 접근할 때 하위 컴포넌트들의 마운트를 기다렸다가 접속하는 건 안된단다.