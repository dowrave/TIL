
## 해야 할 일
#### 할 일
3. 레이아웃 일관성
## 할 수도 있고 안할 수도 있음
- `WritePost`
	- 글을 수정할 때, 기존에 작성된 글이 있는 상태에서 `ctrl + z`를 누르면 내용이 다 사라지는 이슈
	- 코드블럭이 2개 이상일 때 글 수정 시 1개로 합쳐지는 현상이 있음
- 별점 기능 추가하기
	- 방법 1) 별도의 테이블을 추가, 작품명, 별점, 이미지, 리뷰를 추가한다
	- 방법 2) QuillEditor에 별점을 등록할 수 있는 기능만 구현한다

## 기억할 것
- **프론트엔드, 백엔드의 변동 사항은 이미지 빌드부터 다시** 해야 한다.
	- **프론트엔드**에 변동 사항이 생기면, **`npm run build`부터 다시 하고 컨테이너**에 올려야 한다!
	- 백엔드는 **모델의 경우에만** 변동 사항이 생기면 **로컬에서 `python manage.py makemigrations`까지 진행**해야 한다.
- **데이터 백업** : [[MySQL - DB 이전하기#1단계 로컬 MySQL 데이터베이스 백업]] 참고


# 일지

## 24년 4월

### 240410
-  붙여넣기 시 화면 맨 위로 가는 현상 
	- ? `overflow-y-scroll`이랑 관련이 있나? 갑자기 잘 된다.
- 또 `imageapp_image` 관련 이슈 : 이번엔 `image` 테이블 자체가 없단다
	- 마이그레이션이 정상적으로 적용되지 않은 듯 보인다. 
	- 테스트 1) `docker compose.yaml` 파일에서 `depends_on`에 설정한 것들에 추가로 `condition: service_healthy` 조건을 달았다.  (X)
	- 테스트 2) 그냥 `entrypoint.sh`에 아래 코드 추가 (O)
	```sh
python manage.py migrate --fake imageapp zero
python manage.py migrate imageapp
	```
- 이미지 저장 시, **원본 데이터의 해쉬값**을 저장한다. **압축된 데이터를 꺼내 해쉬값을 계산할 필요가 없음**

- 댓글 기능 추가하기 
	- `disqus`를 연동했음. 매우 쉽다.
	- (★) 커스터마이징은 `iframe`으로 불러오므로, `disqus` 사이트의 사이트 관리창에서 해야 한다!

- 구글 애널리틱스도 추가해보자!
	- 

### 240409
- 비염인 줄 알았는데 목이 부었다. 감기걸린 듯.
- 도커 테스크탑을 깔았다가 용량 문제로 지웠는데, 이후로 `docker compose up -d`를 하면 안 먹힌다. [[Docker - Desktop 깔았다 지우고 WSL로 도커 실행 시 발생하는 문제]]
- 전체적인 포트폴리오의 레이아웃을 다듬었는데, 계속 살펴볼 예정. 오늘은 스팀 프로젝트 위주로 살펴봤다.
### 240408
1. (수정 완료) 글쓰기 시 `overflow-y`에 스크롤 적용 안됨 
	- 이거 글 쓸 때는 `overflow-y`는 `scroll`로 둬야 한다
	- 글 쓰기에는 `div.quill`이 상위에 하나 더 있다. 여기에만 `overflow-y-scroll` 추가함.
2. 이미지 관리
	- 업로드 로직 자체는 이미 구현되어 있는데, 현재는 **같은 이미지도 백엔드에서 모두 다른 이미지로 저장하는 구조**를 띄고 있다. 동일한 이미지는 별도의 이미지를 저장하지 않고 이미 있는 이미지를 가져오는 편이 좋을 것이라는 생각.
	- 그렇다면 **동일한 이미지**라는 걸 어떻게 판별할지, 혹은 이미 구현된 것이 있는지를 보는게 좋겠다.
	- 해쉬값을 비교하는 방법이 있나보다.
	- (★)**모델을 변경했는데 마이그레이션이 적용이 안되는 이슈** 가 있었다. 하루 종일.... 해결했는데, 그냥 이럴 때는 **해당 모델이 있는 앱에 `python manage.py migrate {appname} zero` 및 `python manage.py makemigrations`, `python manage.py migrate {appname}`을 적용**해주자.
### 240405
- 프로젝트 통합 & 컨테이너화
	- 스팀 DB 시각화하기 
		1. 레이아웃 다듬기
		2. 2개의 데이터 비교하는 기능 구현하기


### 240404
- 프로젝트 통합 & 컨테이너화
	- 스팀 데이터 수집 프로젝트를 연동한 김에, 프론트엔드에서 간단하게 볼 수 있게끔 프로젝트 페이지에 나타내보려 한다.
		1. 검색어 미리보기 기능 - 데이터가 많기 때문에 어떤 데이터가 있는지 사용자에게 표시할 필요가 있음 
		2. `7일, 30일, 90일, 180일` 정도의 기간동안 `ccu`를 볼 수 있게끔 프론트엔드를 구성하고자 함.
	- **구현 자체는 끝냈고 맵시 정리만 하면 됨**
		- **추가하고 싶은 기능 : 2가지 게임을 비교하기 위해, 입력을 2개 받을 수 있게 구성하기?**
	- 이슈 정리
		1. 시각화 툴은 `recharts`를 이용할 건데, `Tooltip, Legend, Line` 항목이 `JSX element class does not support attributes because it does not have a 'props' property` 오류가 나타남.
			- `npm install --save @types/recharts`로 해결됨. ChatGPT는 타입이 없다고 했는데.....
		2. 위 문제는 생각보다 쉽게 해결했는데, 그 과정에서 라이브러리 버전들을 들쑤시는 바람에 그거 원상복구하고 있다. 
			- `useParams`의 경우 기존 버전은 `| undefined`가 들어가는데, 최신 버전은 `| undefined`가 없어도 되나보다
			- `useNavigate`는 왜인지 못 찾는 이슈가 있어서 그냥 기존 버전으로 되돌려놨음.


### 240403
- 프로젝트 통합 & 컨테이너화
	- 블로그 이전 작업은 다 마무리됨(아마도)
	- 스팀 데이터 수집 과정 컨테이너화해서 스팀 DB에 올리는 거 이쪽 컴퓨터로 옮기겠음!!
	-  1) **기존 DB 컨테이너에 올리기 완료**
	-  2) **기존 수집 과정 컨테이너로 올리기 완료**
		- 생각보다 이전이 간단한데.. 일단 내일 어떻게 작동하는지 보겠음
- 코드 복사 메시지 `clip`되는 문제
	- `ql.editor` 부분에서, `overflow-y-auto` & `overflow-x-visible`로 설정되어 있었는데, 이를 `overflow-visible`로 바꿨다.  x, y의 설정이 다르면 의도하지 않은 표현이 나올 수 있다고 함.

### 240402
- **프로젝트 통합 & 컨테이너화**
	- **`Invalid default value for 'nickname'` 오류 해결** : 해당 에러가 발생하는 백엔드의 앱에서, `migrations` 파일 내부의 `init.py`를 제외한 나머지 파일을 지우고, 다시 로컬에서 `python manage.py makemigrations`을 하고 컨테이너에 올리니까 오류가 더 이상 발생하지 않는다. 아마 기존 `migrations` 파일들과의 충돌이 있었던 것 같음.
	- DB 내용 이전 작업(로컬 -> 컨테이너)
		- [[MySQL - DB 이전하기]]
	- 컨테이너 로그인 테스트
		- 로그인 시 `ImportError: cannot import name 'InvalidKeyError' from 'jwt.exceptions' (/usr/local/lib/python3.10/site-packages/jwt/exceptions.py)` 에러 발생 
		- 로컬에선 잘 되는데, 컨테이너에선 위 에러가 나타남
		- 어... 왜인지 모르게 해결됐다. 
			- `jwt, pyjwt`를 모두 삭제하고, `djangorestframework-simplejwt`와 호환되는 `pyjwt==1.7.1`을 설치했음
	- `subsectionStyle` 수정 시 적용 안되는 이슈... 인 줄 알았는데, `ctrl + F5`를 1번 누르고 나서는 또 잘된다.
	- 텐서플로우 추론은 잘 작동함
	- **코드 하이라이트 기능이 잘 작동하지 않음**
		- 사실 아**래보다는 `import hljs from 'highlight.js/lib/core';` 으로 바꿔서 가져오는 방식이 더 컸을 것 같음.  `highlight.js`로 하면 잘 작동하는듯?**
			- **이게 청크에서 너무 무겁긴 한데, 어쩔 수 없어보인다.**
		- `const handleTextChange = (delta: boolean, oldDelta: boolean, source:Sources)`처럼, `source` 앞에 `delta, oldDelta` 형식으로 지정해야 잘 작동한다.
			- 사용하지 않는 변수는 변수명 앞에 `_`을 붙이란다!
			- 아니면 `_`처럼 써도 되는데, 사용하는 변수 뒤에 `_`이 오는 경우는 '정의되었으나 사용하지 않음' 오류가 발생함 -> 뒤에 주석으로 `eslint-disable-line @typescript-eslint/no-unused-vars`을 추가해준다.
### 240401
- **프로젝트 통합 & 컨테이너화**
	1. 프론트엔드 `serve`되지 않는 문제 : `vite`는 `npm build` 시 `build` 폴더가 아니라 `dist` 폴더를 쓴단다. `serve -s dist -l 5173`으로 바꾸니 로컬에서 실행됨.
	2. 프론트엔드 빌드 과정에서, **부분 청크의 용량이 너무 크다**는 경고문구가 나온다. 확실히 **최초 로딩 속도가 너무 길다**고 느끼긴 해서, 이 부분을 해결해야 함
		1. `App.tsx`의 각 컴포넌트를 `lazyLoading`해봄 : 여기 이슈는 아님. `index`부분이 아니라 `vendor` 부분이 지나치게 큰 게 원인.
		2. **`vendor` 부분은 앱에서 사용하는 외부 라이브러리들임**
			- 1. 사용하지 않는 앱은 삭제
			- 2. 특정 페이지, 컴포넌트에서만 사용되는 라이브러리는 `동적 import`를 적용.
				- 아예 `vite.config.js`에 적용하는 `manualChunk`라는 개념이 있다 : 특정 라이브러리들을 묶어서 필요할 때만 로드되도록 하는 기능임
			- 용량들을 살펴보니, `highlight.js`의 용량이 굉장히 크다. 초기 로딩 속도에 `Quill`과 함께 가장 큰 영향을 주는 요인으로 보임.
			- 사용하는 언어가 한정적이라 일부 언어만으로 `highlight.js`를 구성할까 했는데, 타입스크립트 세팅 등 은근히 손이 좀 간다. 그래서 `highlight`도 `manualChunk`로 빼뒀다.
			- 각 청크가 500kb 미만을 유지하게끔 구성해놨음.
	3. 백엔드 접근 시, 프론트엔드든 호스트든 `table doesn't exist` 에러 발생
		1) SQL 서버가 준비되지 않은 상태에서 시도하는 경우, 해당 에러가 발생할 수 있다고 함 -> 백엔드의 대기 시간을 10초로 늘려봄 -> `entrypoint.sh`을 구성, SQL 서버 로 완료 시 연결되도록 구성
		2) 엔트리포인트 실행 안되는 문제 해결
		3) 똑같이 `mysql 8.0.36` 버전인데, **컨테이너에서만 `Invalid default value for 'nickname'` 오류가 발생한다..... 일단 오늘은 여기까지 ㅠㅠㅠㅠㅠ**
